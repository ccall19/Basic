# Python 数据结构速查总述

本文档旨在快速查阅 Python 常用数据结构的核心用法，重点在于**如何使用**。

## 1. 列表 (List) `[]`
有序、可变、允许重复。

### 常用操作
```python
# 创建
nums = [1, 2, 3, 4, 5]
empty = []

# 查 (索引与切片)
first = nums[0]      # 1
last = nums[-1]      # 5
sub = nums[1:3]      # [2, 3] (左闭右开)
rev = nums[::-1]     # [5, 4, 3, 2, 1] (反转)

# 增
nums.append(6)       # 末尾添加: [..., 5, 6]
nums.insert(0, 0)    # 指定位置插入: [0, 1, ...]
nums.extend([7, 8])  # 合并列表: [..., 6, 7, 8]

# 删
x = nums.pop()       # 移除并返回末尾元素 (默认索引 -1)
nums.remove(3)       # 移除第一个值为 3 的元素 (不存在报错)
del nums[0]          # 删除指定索引元素
nums.clear()         # 清空

# 改
nums[0] = 100

# 查 (判断)
if 2 in nums: pass
idx = nums.index(4)  # 查找值的索引 (不存在报错)
count = nums.count(2)# 统计出现次数

# 排序
nums.sort()          # 原地升序
nums.sort(reverse=True) # 原地降序
new_list = sorted(nums) # 返回新列表，原列表不变
```

## 2. 元组 (Tuple) `()`
有序、**不可变**、允许重复。常用于函数返回多值或作为字典 Key。

### 常用操作
```python
# 创建
t = (1, 2, 3)
single = (1,)        # 单个元素必须加逗号

# 查 (同列表)
val = t[0]
sub = t[1:]

# 解包 (Unpacking)
a, b, c = t
x, *rest = t         # x=1, rest=[2, 3]

# 转换
l = list(t)          # 转列表
```

## 3. 字典 (Dict) `{k: v}`
无序 (3.7+ 插入有序)、Key 唯一且不可变。

### 常用操作
```python
# 创建
d = {'name': 'Tom', 'age': 18}
d = dict(name='Tom', age=18)

# 查
val = d['name']      # Key 不存在报错
val = d.get('age', 0)# Key 不存在返回默认值 0 (推荐)

# 增 / 改
d['gender'] = 'M'    # 新增
d['age'] = 19        # 修改
d.update({'a': 1})   # 批量更新/合并

# 删
val = d.pop('name')  # 删除并返回 Value
del d['age']         # 删除 Key
d.popitem()          # 删除并返回最后一个 (Key, Value) 对

# 遍历
for k in d: pass            # 遍历 Key
for k in d.keys(): pass     # 遍历 Key
for v in d.values(): pass   # 遍历 Value
for k, v in d.items(): pass # 遍历 Key-Value
```

## 4. 集合 (Set) `{}`
无序、**不重复**、元素必须不可变 (Hashable)。常用于去重和集合运算。

### 常用操作
```python
# 创建
s = {1, 2, 3}
empty = set()        # 注意：{} 是空字典

# 增
s.add(4)
s.update([5, 6])     # 批量添加

# 删
s.remove(1)          # 不存在报错
s.discard(2)         # 不存在不报错 (推荐)
val = s.pop()        # 随机移除并返回

# 集合运算
s1 = {1, 2, 3}
s2 = {3, 4, 5}

union = s1 | s2      # 并集 {1, 2, 3, 4, 5}
inter = s1 & s2      # 交集 {3}
diff = s1 - s2       # 差集 {1, 2} (s1 有 s2 没有)
sym_diff = s1 ^ s2   # 对称差集 {1, 2, 4, 5} (不共有的)
```

## 5. 字符串 (String) `""`
有序、不可变字符序列。

### 常用操作
```python
s = " Hello World "

# 处理
s = s.strip()        # 去除首尾空格
l = s.split(' ')     # 分割成列表
j = '-'.join(l)      # 列表拼接成字符串: "Hello-World"
s = s.replace('l', 'L') # 替换 (返回新字符串)
s = s.lower()        # 转小写
s = s.upper()        # 转大写

# 查找
idx = s.find('World')# 返回索引，找不到返回 -1
idx = s.index('W')   # 找不到报错
is_start = s.startswith('He')

# 格式化 (f-string)
name = "Tom"
msg = f"Hi, {name}"
```

## 6. 栈与队列 (Stack & Queue)

### 栈 (Stack) - 后进先出 (LIFO)
Python 没有专门的 Stack 类，通常直接使用 `list`。

```python
stack = []

# 入栈
stack.append(1)
stack.append(2)

# 出栈
if stack:
    val = stack.pop() # 返回 2
    
# 查看栈顶
top = stack[-1]       # 2
```

### 队列 (Queue) - 先进先出 (FIFO)
使用 `collections.deque` (双端队列) 性能最高，O(1) 时间复杂度。

```python
from collections import deque

q = deque()

# 入队
q.append(1)
q.append(2)

# 出队
if q:
    val = q.popleft() # 返回 1 (注意是 popleft)
```

### 优先队列 (Priority Queue / Heap)
使用 `heapq` 模块实现最小堆。

```python
import heapq

h = [] # 普通 list

# 入堆 (自动维持最小堆顺序)
heapq.heappush(h, 3)
heapq.heappush(h, 1)
heapq.heappush(h, 2) # h 变为 [1, 3, 2]

# 出堆 (弹出最小值)
min_val = heapq.heappop(h) # 返回 1

# 最大堆
# 入堆时取负
heapq.heappush(h, -3)
heapq.heappush(h, -1)
heapq.heappush(h, -2)

# 取出最大值（记得再取负）
max_val = -heapq.heappop(h)  # 3

# 获取最小值 (不弹出)
min_val = h[0]

# 将现有列表转为堆
nums = [5, 7, 1]
heapq.heapify(nums)    # 原地转换 O(n)
```

## 7. 高级容器 (Collections)
`collections` 模块提供了许多实用的数据结构。

### Counter (计数器)
用于统计元素出现次数。

```python
from collections import Counter

c = Counter("hello world")
# Counter({'l': 3, 'o': 2, 'h': 1, 'e': 1, ' ': 1, 'w': 1, 'r': 1, 'd': 1})

# 获取计数
count = c['l']       # 3
top_2 = c.most_common(2) # [('l', 3), ('o', 2)]

# 运算
c.update("hello")    # 增加计数
```

### defaultdict (默认字典)
访问不存在的 Key 时自动创建默认值，避免 KeyError。

```python
from collections import defaultdict

# 默认值为 int (0)
d_int = defaultdict(int)
d_int['a'] += 1      # 'a' 不存在时自动初始化为 0，然后 +1

# 默认值为 list ([])
d_list = defaultdict(list)
d_list['users'].append('Tom') # 'users' 不存在时自动初始化为 []
```

### namedtuple (具名元组)
创建简单的类，像元组一样不可变，但可以通过属性名访问。

```python
from collections import namedtuple

Point = namedtuple('Point', ['x', 'y'])
p = Point(10, 20)

print(p.x, p.y)      # 10 20
# p.x = 30           # 报错：不可变
```

## 8. 常用转换速查

| 目标类型 | 方法 | 说明 |
| :--- | :--- | :--- |
| List | `list(x)` | 字符串转字符列表，元组转列表 |
| Tuple | `tuple(x)` | 列表转元组 |
| Set | `set(x)` | 列表/元组去重 |
| String | `str(x)` | 任意对象转字符串 |
| String | `''.join(list)` | 字符列表转字符串 |
